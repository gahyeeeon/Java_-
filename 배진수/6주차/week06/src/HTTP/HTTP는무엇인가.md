# HTTP는 무엇인가
## HTTP 란? - Hyper Text Transfer Protocol

- 서버와 클라이언트가 서로 데이터를 주고받기 위해 사용되는 통신 규약을 말일컷는다
- 웹 문서간에 링크를 통해 연결할 수 있는 프로토콜이며, 문서 뿐 아니라 다음과 같은 여러 종류의 데이터들을 폭 넓게 전송할 수가 있다
    - HTML, TEXT
    - IMAGE, 음성, 영상, 파일
    - JSON, XML(API)
    - 거의 모든 형태의 데이터가 전송 가능

## HTTP의 통신 구조

- HTTP 통신은 클라이언트(Front-End)와 서버(Back-End)로 나뉘어진 구조로 되어있다
- 클라이언트가 요청(Request)하면 서버가 응답(Response) 하는 것이다
- 통신하는데에 있어 클라이언트와 서버를 분리하는 이유
    - 각자의 역할에 집중할 수 있기 때문

## HTTP의 무상태성(Stateless)

- 무상태(Stateless) : 클라이언트와 서버 사이에 상태를 유지하지 않는다
- 장점 : 서버 확장성 높음 (스케일 아웃)
- 단점 : 클라이언트가 추가 데이터 전송 (메모리 ↑)

### 상태유지(Stateful)

- 서버가 클라이언트의 상태를 보존한다
- 대표적인 예로 홈페이지에서 회원 로그인을 하면, 페이지를 옮겨가도 서버는 클라이언트의 상태를 보존하기 때문에 그 클라이언트가 회원인지 안다
- 하지만 중간에 서버가 장애나면 클라리언트는 처음부터 다시 작업을 요청해야한다
- 그래서 서버가 바뀔때마다 클라이언트의 내용을 기록해서 상태를 유지해야하는데 쉽지 않다

### 무상태(Stateless)

- 서버가 클라이언트의 상태를 보존하지 않는다
- 홈페이지에서 회원 로그인을 하고 페이지를 옮겼는데 또 로그인을 하라는 페이지가 뜬다. 왜냐하면 서버는 클라이언트의 상태를 보존하지 않기 때문에 그 클라이언트가 회원인지 모르기 때문이다
- 따라서 무상태 환경에선 회원 정보를 서버가 아닌 클라이언트가 토큰 형태로 들고 있으면서, 서버와 통신할때 실어 보내 인증하는 식이다
- 이러한 무상태 환경은 클라이언트가 상태 정보를 갖고 있는 것이기 때문에, 아무 서버나 호출해도 되기 때문에 서버의 스케일 아웃에 유리하다
- 하지만 상태유지보다 데이터를 많이 사용한다는 단점이 있다

## HTTP의 비연결성(Connectionless)

- HTTP는 기본이 연결을 유지하지 않는 모델이다
- 즉, 서버와 클라이언트의 Connection 연결을 지속하지 않는다
- 1시간동안 수천명 이상이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이하로 적다
- 예를 들어 웹 브라우저 검색페이지에서 검색버튼만 연타하면서 이용하지는 않는듯이 말이다
- 이러한 비연결성 특성 때문에 서버 자원을 매우 요율적으로 사용할 수 있다

### 연결을 유지하는 모델

- 연결을 유지한다면, 서버와 클라이언트의 연결은 서로의 네트워킹 요청이 없더라도 계속해서 유지된다.
- 자원이 계속해서 사용된다 (이러한 점 때문에, HTTP는 기본적으로 연결을 유지하지 않는 모델이다)

### 연결을 유지하지 않는 모델

- 연결을 유지하지 않는다면, 서버의 자원을 효율적으로 사용할 수 있다
- 다만, 클라이언트가 연결을 계속 끊는다는 것은 TCP/IP 연결을 매번 새롭게 맺어야 한다는 것을 뜻한다
- 즉, TCP 3 way handshake를 매번 해야하고, 이는 시간이 걸린다
- 이러한 문제는 지금 HTTP 지속 연결(Persistent Connections)로 문제 해결하고 있다
- HTTP/2, HTTP/3 에서 더 많은 최적화가 이루어 졌다

### 비연결성 한계 - 단기 커넥션

- HTTP 초기 - 연결, 종료 낭비
- 웹 브라우저로 사이트를 요청하면 HTML 뿐만 아니라 자바스크립트, css, 추가 이미지 등등 수 많은 자원이 함께 다운로드 되는데, 새로 연결을 맺을 때 마다 TCP handshake가 발생한다는 문제점이 있음
- 그래서 HTTP 초기에는 모든 자료에 대해서 비연결성으로 각각의 자원에 대해 연결/ 응답/ 종룔를 반복하다보니 대략적으로 1초가량 소요되었다

### 비연결성 극복 - HTTP 지속 연결

- 클라이언트는 서버와 소켓 연결을 한 다음 필요한 자원을 요청/응답으로 다운로드 받는다
- 소켓 연결을 일정 시간동안 더 유지함으로써, 필요한 자원들을 모두 다운받을때까지 연결이 종료되지않고 요청/응답이 반복된 뒤 종료

## HTTP 상태 코드

- 상태코드는 클라이언트가 보낸 요청의 처리 상태를 응답에서 알려주는 기능으로서, 3자리 숫자로 만들어져 있으며, 100 ~ 500 번대 숫자로 이루어져 있다
- 예를 들어 첫번째 자리가 4와 5인 경우는 정상적인 상황이 아니기 때문에 사이트 관리자가 즉시 알아야 하는 정보이다
    - 1xx(정보) : 요청을 받았으며 프로세스를 계속 진행
    - 2xx(성공) : 요청을 성공적으로 받았으며 인식했고 수용
    - 3xx(리다이렉션) : 요청 완료를 위해 추가 작업 조치가 필요
    - 4xx(클라이언트 오류) : 요총의 문법이 잘못되었거나 요청을 처리할 수 없음
    - 5xx(서버 오류) : 서버가 명백히 유효한 요청에 대한 충족을 실패

### HTTP 메세지

HTTP 메세지 구조

![스크린샷 2024-05-06 오후 4.10.30.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/f4b917bb-af79-49e7-a149-2d362964fbfb/594347bb-8ee7-4a23-9562-cf5fbeebf662/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-05-06_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.10.30.png)

## HTTP 메서드

- 클라이언트와 서버 사이에 이루어지는 요청과 응답 데이터를 전송하는 방식을 일컫는다
- 서버에 주어진 리소스에 수행하길 원하는 행동, 서버가 수행해야할 동작을 지정하는 요청을 보내는 방법이다

### 주요 메소드 5가지

- GET
- POST
- PUT
- PATCH
- DELETE

### 기타 메소드 4가지

- HEAD
- OPTIONS
- CONNECT
- TRACE
-

## HTTP메서드 특성

### 안정성(safe)

- 호출해도 리소스 변경이 일어나지 않는 속성
- 여기서 안전의 기준은 오직 리소스 변경 가능성이며, 외적인 요소는 포함하지 않는다
- GET, HEAD를 안전한 메소드라고 볼 수 있다. (POST, PUT, PATCH, DELETE는 리소스를 변경하는 메소드이므로)

### 멱등성(Idempotent)

- 동일한 요청을 여러 번 보내도 한 번 보내는 것과 같은 것
- 같은 행위를 여러 번 반복하더라도 같은 효과를 받으며, 서버의 상태로 동일하게 남음
- 멱등성은 요청의 결과를 보고 판단
- TimeOut 등으로 클라이언트가 서버로부터 정상 응답을 받지 못 했을 때 같은 요청을 다시 해도 되는지 판단하는 근거
- GET : 몇 번을 조회하더라도 같은 결과가 조회된다. ⇒ 회원 정보를 몇번을 조회한다고 정보가 달라지지 않는다
- PUT : 결과를 대체한다. 따라서 같은 요청을 여러번해도 최종 결과는 같다
- DELETE : 결과를 삭제한다. 같은 요청을 여러번 해도 삭제된 결과는 같다
- POST : 멱등이 아니다. 두 번 호출하면 에러가 발생할 수 있따 ⇒ POST로 주문을 두 번 호출하면 결제가 중복될 수 있다

### 캐시 가능 (Cacheable)

- 응답 결과를 캐시해 사용할 수 있는 속성
- GET, HEAD, POST, PATCH가 캐시 가능하나, Message Body의 캐시 키의 복잡성 문제로 실제로는 GET, HEAD만 사용